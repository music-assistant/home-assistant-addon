profile music_assistant_addon flags=(attach_disconnected,mediate_deleted) {
  #include <abstractions/base>

  capability,
  file,
  signal (send) set=(kill,term,int,hup,cont),

  # Network access
  network inet stream,
  network inet dgram,
  network inet6 stream,
  network inet6 dgram,
  network netlink raw,
  network unix dgram,
  network unix stream,

  capability setgid,
  capability setuid,
  capability sys_admin,
  capability dac_read_search,
  capability sys_nice,

  # Basic file access
  /dev/* mrwkl,
  /tmp/** mrkwl,
  /proc/* r,
  /sys/bus/ r,
  /sys/class/ r,

  # Data access
  /data/** rw,
  /media/** rw,

  # D-Bus access (following Home Assistant supervisor pattern)
  #include <abstractions/dbus>
  unix (send, receive) type=stream,
  /run/dbus/system_bus_socket rw,
  /var/run/dbus/system_bus_socket rw,

  # docker daemon confinement requires explict allow rule for signal
  signal (receive) set=(kill,term) peer=/usr/bin/docker,

}